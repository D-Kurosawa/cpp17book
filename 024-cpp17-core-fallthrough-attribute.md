## [[fallthrough]]属性

`[[fallthrough]]`属性は`switch`文の中の`case`ラベルを突き抜けるというヒントを出すのに使える。

`switch`文では対応する`case`ラベルに処理が移る。通常、以下のように書く。


~~~cpp
void f( int x )
{
    switch ( x )
    {
    case 0 :
        // 処理0
        break ;
    case 1 :
        // 処理1
        break ;
    case 2 :
        // 処理2
        break ;
    default :
        // xがいずれでもない場合の処理
        break ;
    }
}
~~~

この例を以下のように書くと

~~~c++
case 1 :
    // 処理1
case 2 :
    // 処理2
    break ;
~~~


`x`が1のときは処理1を実行した後に、処理2も実行される。`switch`文を書くときはこのような誤りを書いてしまうことがある。そのため、賢いC++コンパイラーは`switch`文の`case`ラベルで`break`文や`return`文などで処理が終わらず、次の`case`ラベルや`default`ラベルに処理に突き抜けるコードを発見すると、警告メッセージを出す。


しかし、プログラマーの意図がまさに突き抜けて処理してほしい場合、警告メッセージは誤った警告となってしまう。そのような警告メッセージを抑制するため、またコード中に処理が突き抜けるという意図をわかりやすく記述するために、`[[fallthrough]]`属性が追加された。

~~~c++
case 1 :
    // 処理1
    [[fallthrough]]
case 2 :
    // 処理2
    break ;
~~~

`[[fallthrough]]`属性を書くと、C++コンパイラーは処理がその先に突き抜けることがわかるので、誤った警告メッセージを抑制できる。また、他人がコードを読むときに意図が明らかになる。


機能テストマクロは`__has_cpp_attribute(fallthrough)`, 値は201603。
